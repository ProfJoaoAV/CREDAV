<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boss Battle - Gamificação na Educação</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #1a1a2e;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }
        .pixel-font {
            font-family: 'Press+Start+2P', cursive;
            font-size: 0.8rem;
        }
        .monster-container {
            transition: all 0.3s ease;
        }
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .health-bar-fill {
            transition: width 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), background-color 0.3s;
        }
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .particle {
            position: absolute;
            pointer-events: none;
            opacity: 0;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <!-- Header -->
    <div class="mb-8 text-center">
        <h1 class="text-3xl font-bold text-purple-400 mb-2 uppercase tracking-widest">Batalha Final</h1>
        <p class="text-gray-400">Responde corretamente para derrotar o Boss!</p>
    </div>

    <!-- Monster Area -->
    <div id="game-container" class="relative flex flex-col items-center justify-center bg-gray-900 rounded-3xl p-8 border-4 border-purple-500 shadow-2xl w-full max-w-2xl overflow-hidden">
        
        <!-- Health Bar -->
        <div class="w-full mb-8 relative">
            <div class="flex justify-between mb-2 pixel-font">
                <span>HP DO BOSS</span>
                <span id="health-text">30/30</span>
            </div>
            <div class="w-full h-8 bg-gray-800 rounded-full border-2 border-white overflow-hidden">
                <div id="health-fill" class="health-bar-fill h-full bg-green-500" style="width: 100%"></div>
            </div>
        </div>

        <!-- Monster Visual -->
        <div id="monster-sprite" class="monster-container floating relative z-10">
            <svg id="monster-svg" width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                <!-- Body -->
                <circle cx="100" cy="100" r="80" fill="#8b5cf6" id="monster-body" />
                <!-- Eyes -->
                <g id="eyes">
                    <circle cx="70" cy="85" r="15" fill="white" />
                    <circle cx="70" cy="85" r="7" fill="black" id="pupil-l" />
                    <circle cx="130" cy="85" r="15" fill="white" />
                    <circle cx="130" cy="85" r="7" fill="black" id="pupil-r" />
                </g>
                <!-- Mouth -->
                <path id="mouth" d="M 60 130 Q 100 160 140 130" stroke="white" stroke-width="5" fill="none" />
                <!-- Horns -->
                <path d="M 50 40 L 70 70 L 30 60 Z" fill="#6d28d9" />
                <path d="M 150 40 L 130 70 L 170 60 Z" fill="#6d28d9" />
            </svg>
        </div>

        <!-- Status Message -->
        <div id="status-msg" class="mt-6 text-xl font-bold text-center h-8">
            O Boss está à espera do vosso ataque!
        </div>
    </div>

    <!-- Controls -->
    <div class="mt-10 flex gap-6">
        <button onclick="handleAttack()" id="btn-hit" class="bg-green-600 hover:bg-green-500 text-white px-8 py-4 rounded-xl font-bold shadow-lg transform active:scale-95 transition flex items-center gap-2">
            ✅ RESPOSTA CERTA (-1 HP)
        </button>
        <button onclick="handleMiss()" id="btn-miss" class="bg-red-600 hover:bg-red-500 text-white px-8 py-4 rounded-xl font-bold shadow-lg transform active:scale-95 transition flex items-center gap-2">
            ❌ TURMA FALHOU (+1 HP)
        </button>
    </div>

    <!-- Restart -->
    <button onclick="resetGame()" class="mt-8 text-gray-500 hover:text-white underline pixel-font">Reiniciar Batalha</button>

    <script>
        let health = 30;
        const maxHealth = 30;
        const healthFill = document.getElementById('health-fill');
        const healthText = document.getElementById('health-text');
        const monsterSprite = document.getElementById('monster-sprite');
        const monsterBody = document.getElementById('monster-body');
        const mouth = document.getElementById('mouth');
        const statusMsg = document.getElementById('status-msg');
        const btnHit = document.getElementById('btn-hit');
        const btnMiss = document.getElementById('btn-miss');

        function updateUI() {
            const percentage = (health / maxHealth) * 100;
            healthFill.style.width = percentage + '%';
            healthText.innerText = `${health}/${maxHealth}`;

            // Update Colors
            if (percentage > 50) {
                healthFill.className = 'health-bar-fill h-full bg-green-500';
                monsterBody.setAttribute('fill', '#8b5cf6'); // Purple
                mouth.setAttribute('d', 'M 60 130 Q 100 160 140 130'); // Happy
                statusMsg.innerText = "O Boss está confiante!";
            } else if (percentage > 20) {
                healthFill.className = 'health-bar-fill h-full bg-yellow-500';
                monsterBody.setAttribute('fill', '#d946ef'); // Pink/Angry
                mouth.setAttribute('d', 'M 60 140 Q 100 140 140 140'); // Flat
                statusMsg.innerText = "O Boss está a ficar irritado!";
            } else if (health > 0) {
                healthFill.className = 'health-bar-fill h-full bg-red-500';
                monsterBody.setAttribute('fill', '#f43f5e'); // Red/Hurt
                mouth.setAttribute('d', 'M 60 150 Q 100 130 140 150'); // Sad
                statusMsg.innerText = "O Boss está quase a cair!";
            } else {
                statusMsg.innerText = "VITÓRIA! O BOSS FOI DERROTADO!";
                statusMsg.className = "mt-6 text-xl font-bold text-center text-yellow-400 animate-bounce";
                monsterSprite.style.opacity = "0.3";
                monsterSprite.classList.remove('floating');
                btnHit.disabled = true;
                btnMiss.disabled = true;
                btnHit.style.opacity = "0.5";
                btnMiss.style.opacity = "0.5";
            }
        }

        function handleAttack() {
            if (health <= 0) return;
            
            health--;
            if (health < 0) health = 0;
            
            // Visual Feedback
            monsterSprite.classList.add('shake');
            setTimeout(() => monsterSprite.classList.remove('shake'), 500);
            
            createParticles('#ffeb3b');
            updateUI();
        }

        function handleMiss() {
            if (health <= 0) return;
            if (health < maxHealth) {
                health++;
            }
            
            // Monster "Laughs"
            monsterSprite.style.transform = "scale(1.2)";
            setTimeout(() => monsterSprite.style.transform = "scale(1)", 300);
            
            createParticles('#f44336');
            updateUI();
        }

        function createParticles(color) {
            for(let i=0; i<8; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.width = '10px';
                p.style.height = '10px';
                p.style.backgroundColor = color;
                p.style.borderRadius = '50%';
                p.style.left = '50%';
                p.style.top = '50%';
                
                document.getElementById('game-container').appendChild(p);
                
                const angle = Math.random() * Math.PI * 2;
                const dist = 50 + Math.random() * 100;
                const tx = Math.cos(angle) * dist;
                const ty = Math.sin(angle) * dist;

                p.animate([
                    { transform: 'translate(-50%, -50%) scale(1)', opacity: 1 },
                    { transform: `translate(calc(-50% + ${tx}px), calc(-50% + ${ty}px)) scale(0)`, opacity: 0 }
                ], {
                    duration: 600,
                    easing: 'ease-out'
                }).onfinish = () => p.remove();
            }
        }

        function resetGame() {
            health = 30;
            statusMsg.className = "mt-6 text-xl font-bold text-center h-8";
            monsterSprite.style.opacity = "1";
            monsterSprite.classList.add('floating');
            btnHit.disabled = false;
            btnMiss.disabled = false;
            btnHit.style.opacity = "1";
            btnMiss.style.opacity = "1";
            updateUI();
        }

        // Initial UI Update
        updateUI();
    </script>
</body>
</html>
